class sesmMain{sesm_do="";field_names={};construct(){jQuery(document).ready((async function(){await import("./modules/ajax.js").then(module=>{sesm_scripts.ajax=new module.SesmAjax}),await import("./modules/template.js").then(module=>{sesm_scripts.template=new module.SesmTemplate}),await sesm_scripts.template.load_default_templates(),sesm_scripts.load_field_names(),sesm_scripts.add_event_listener(),sesm_scripts.activate_sesm(),sesm_scripts.is_mobile()}))}load_field_names(){this.field_names.price_title=__("Price","sesm"),this.field_names.weight_title=__("Weight","sesm"),this.field_names.quantity_title=__("Quantity","sesm"),this.field_names.sku_title=__("SKU","sesm"),this.field_names.iconclass=""}is_mobile(){if(jQuery(window).width()>500)return!1;jQuery("#sesm_sku_input").attr("placeholder",__("Input SKU","sesm"))}add_event_listener(){jQuery("#sesm_buttons button").click((function(){switch(sesm_scripts.sesm_do=jQuery(this).data("do"),jQuery("#sesm_input .quant_flex_group").hide(),jQuery("#sesm_input .price_flex_group").hide(),jQuery("#sesm_buttons button.button-active").removeClass("button-active"),jQuery("#sesm_sku_input").show(),jQuery("#sesm_sku_input").focus(),jQuery(this).addClass("button-active"),jQuery("#sesm_buttons #selection-indicator").show(),sesm_scripts.move_selection_indicator(),sesm_scripts.sesm_do){case"add_quantities":jQuery(".sesm_options .quant_flex_group").slideDown("fast");break;case"update_price":jQuery(".sesm_options .price_flex_group").slideDown("fast")}})),jQuery(document).on("keyup",(function(s){13==s.which&&(sesm_scripts.ajax.do_ajax(),jQuery("#sesm_sku_input").val(""))})),jQuery("#add_quant_btn").click((function(){sesm_scripts.changeQuantity(!0)})),jQuery("#remove_quant_btn").click((function(){sesm_scripts.changeQuantity(!1)})),jQuery(window).resize(()=>{sesm_scripts.move_selection_indicator(0),sesm_scripts.is_mobile()})}activate_sesm(){jQuery("#sesm_buttons").show("slow")}move_selection_indicator(animation_duration=200){const active_position=jQuery("#sesm_buttons .button-active").offset().left,first_button_position=jQuery("#sesm_buttons button:first-child").offset().left;jQuery("#selection-indicator").animate({left:active_position-first_button_position+jQuery("#sesm_buttons .button-active").width()/2},animation_duration)}addToHistory(json_data){var template=this.get_template_by_state(json_data.template);this.empty(template)&&jQuery("#sesm_history").prepend(__(`Template "${json_data.template}" not loaded`,"sesm")),this.set_icon_class(json_data.template);const attr=this.format_attributes(json_data);this.empty(attr)||(json_data.attributes=attr),jQuery.each(json_data,(function(key,value){value=sesm_scripts.format_value(key,value,json_data),template=template.replaceAll("{{"+key+"}}",value)})),jQuery.each(this.field_names,(function(key,value){value=sesm_scripts.format_value(key,value),template=template.replaceAll("{{"+key+"}}",value)})),jQuery("#sesm_history").addClass("active"),jQuery("#sesm_history").prepend(template),jQuery("#sesm_history article").first().animate({opacity:1,height:"100%"},500)}get_template_by_state(state){switch(state){case"error":return sesm_scripts.template.loaded_templates.error;case"updateStock":return sesm_scripts.template.loaded_templates.updatestock;case"updatePrice":return sesm_scripts.template.loaded_templates.updateprice;default:return sesm_scripts.template.loaded_templates.item}}set_icon_class(template){let classname="";switch(template){case"get":classname="fas fa-question";break;case"updateStock":classname="fas fa-box-open";break;case"updatePrice":classname="far fa-money-bill-alt"}this.field_names.iconclass=classname}format_attributes(json_data){return this.empty(json_data.attributes)?"":json_data.attributes.replace(", ","<br/>")}format_value(field_name,value,json_data){if("to_regular"===field_name||"to_sale"===field_name)var price_length=(json_data.from_regular+json_data.to_regular+json_data.currency).length,price_length_sale=(json_data.from_sale+json_data.to_sale+json_data.currency).length;switch(field_name){case"stock_quantity":var number=parseInt(value);return number<1?"<span class='red'>"+number+"</span>":value;case"regular_price":return json_data.sale_price?'<span class="strikethrough">'+value+" "+json_data.currency+"</span>":value+" "+json_data.currency;case"weight":return value+" kg";case"sale_price":return json_data.sale_price?value+" "+json_data.currency:"";case"manage_stock":return!1!==value?"":__("Stock management got activated","sesm");case"to_regular":const class_long_content=price_length+price_length_sale>7||json_data.to_sale>0?"content-long":"",is_single_regular_class=0===json_data.to_sale?"single":"";return 0===value?"":'<div class="'+class_long_content+" "+is_single_regular_class+'"><span class="from_price strikethrough">'+json_data.from_regular+" "+json_data.currency+'</span><span class="to_price">'+value+" "+json_data.currency+"</span></div>";case"to_sale":const class_long_content_sale=price_length+price_length_sale>7||json_data.to_regular>0?"content-long":"",is_single_sale_class=0===json_data.to_regular?"single":"";return 0===value?"":'<div class="'+class_long_content_sale+" "+is_single_sale_class+'"><span class="from_price strikethrough">'+json_data.from_sale+" "+json_data.currency+'</span><span class="to_price">'+value+" "+json_data.currency+"</span></div>";default:return value}}changeQuantity(s){this.empty(jQuery("#sesm_quant").val())&&jQuery("#sesm_quant").val(0);var e=parseInt(jQuery("#sesm_quant").val()),a=0;a=!0===s?e+1==0?1:e+1:e-1==0?-1:e-1,jQuery("#sesm_quant").val(a),jQuery("#sesm_sku_input").focus()}empty(value){return null===value||(void 0===value||0===value.length)}}const{__:__,_x:_x,_n:_n,_nx:_nx}=wp.i18n;let sesm_scripts=new sesmMain;sesm_scripts.construct();