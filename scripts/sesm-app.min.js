class sesmMain{sesm_do="";field_names={};construct(){jQuery(document).ready((async function(){await import("./modules/ajax.js").then(module=>{sesm_scripts.ajax=new module.SesmAjax}),await import("./modules/template.js").then(module=>{sesm_scripts.template=new module.SesmTemplate}),await sesm_scripts.template.load_default_templates(),sesm_scripts.load_field_names(),sesm_scripts.add_event_listener(),sesm_scripts.activate_sesm()}))}load_field_names(){this.field_names.price_title=__("Price","sesm"),this.field_names.weight_title=__("Weight","sesm"),this.field_names.quantity_title=__("Quantity","sesm"),this.field_names.sku_title=__("SKU","sesm"),this.field_names.iconclass=""}add_event_listener(){jQuery("#sesm_buttons button").click((function(){sesm_scripts.sesm_do=jQuery(this).data("do"),jQuery("#sesm_input input").hide(),jQuery("#sesm_input label").hide(),jQuery("#sesm_input .quant_flex_group").hide(),jQuery("#sesm_sku_input").show(),jQuery("[for=sesm_sku_input]").show(),jQuery("#sesm_sku_input").focus(),jQuery(".sesm_input."+sesm_scripts.sesm_do).show(),jQuery(".sesm_label."+sesm_scripts.sesm_do).show(),jQuery("#sesm_buttons button.button-active").removeClass("button-active"),jQuery(this).addClass("button-active")})),jQuery(document).on("keyup",(function(s){13==s.which&&(sesm_scripts.ajax.do_ajax(),jQuery("#sesm_sku_input").val(""))})),jQuery("#add_quant_btn").click((function(){sesm_scripts.changeQuantity(!0)})),jQuery("#remove_quant_btn").click((function(){sesm_scripts.changeQuantity(!1)}))}activate_sesm(){jQuery("#sesm_buttons").show("slow")}addToHistory(json_data){var template=this.get_template_by_state(json_data.template);this.empty(template)&&jQuery("#sesm_history").prepend(__(`Template "${json_data.template}" not loaded`,"sesm")),this.set_icon_class(json_data.template);const attr=this.format_attributes(json_data);this.empty(attr)||(json_data.attributes=attr),jQuery.each(json_data,(function(key,value){value=sesm_scripts.format_value(key,value,json_data),template=template.replaceAll("{{"+key+"}}",value)})),jQuery.each(this.field_names,(function(key,value){value=sesm_scripts.format_value(key,value),template=template.replaceAll("{{"+key+"}}",value)})),jQuery("#sesm_history").addClass("active"),jQuery("#sesm_history").prepend(template)}get_template_by_state(state){switch(state){case"error":return sesm_scripts.template.loaded_templates.error;case"updateStock":return sesm_scripts.template.loaded_templates.updatestock;case"updatePrice":return sesm_scripts.template.loaded_templates.updateprice;default:return sesm_scripts.template.loaded_templates.item}}set_icon_class(template){let classname="";switch(template){case"get":classname="fas fa-question";break;case"updateStock":classname="fas fa-box-open";break;case"updatePrice":classname="far fa-money-bill-alt"}this.field_names.iconclass=classname}format_attributes(json_data){return this.empty(json_data.attributes)?"":json_data.attributes.replace(", ","<br/>")}format_value(template_name,value,json_data){switch(template_name){case"stock_quantity":var number=parseInt(value);return number<1?"<span class='red'>"+number+"</span>":value;case"regular_price":return json_data.sale_price?'<span class="strikethrough">'+value+" "+json_data.currency+"</span>":value+" "+json_data.currency;case"weight":return value+" kg";case"sale_price":return json_data.sale_price?value+" "+json_data.currency:"";case"manage_stock":return!1!==value?"":__("Stock management got activated","sesm");case"to_regular":return 0===value?"":'<div><span class="from_price strikethrough">'+json_data.from_regular+" "+json_data.currency+'</span> <span class="to_price">'+value+json_data.currency+"</span></div>";case"to_sale":return 0===value?"":'<div><span class="from_price strikethrough">'+json_data.from_sale+" "+json_data.currency+'</span> <span class="to_price">'+value+json_data.currency+"</span></div>";default:return value}}changeQuantity(s){var e=parseInt(jQuery("#sesm_quant").val()),a=0;a=!0===s?e+1==0?1:e+1:e-1==0?-1:e-1,jQuery("#sesm_quant").val(a),jQuery("#sesm_sku_input").focus()}empty(value){return null===value||(void 0===value||0===value.length)}}const{__:__,_x:_x,_n:_n,_nx:_nx}=wp.i18n;let sesm_scripts=new sesmMain;sesm_scripts.construct();